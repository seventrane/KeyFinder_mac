<html><head>
    <title>Ear training App</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="stylesheets/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/3.0.0/mdb.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>


    <style>
       /*local style*/

       /* SLIDER SWITCH STYLES */

       .switch {
          position: relative;
          display: inline-block;
          width: 60px;
          height: 34px;
        }

        .switch input { 
          opacity: 0;
          width: 0;
          height: 0;
        }

        .slider {
          position: absolute;
          cursor: pointer;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background-color: #ccc;
          -webkit-transition: .4s;
          transition: .4s;
        }

        .slider:before {
          position: absolute;
          content: "";
          height: 26px;
          width: 26px;
          left: 4px;
          bottom: 4px;
          background-color: white;
          -webkit-transition: .4s;
          transition: .4s;
        }

        input:checked + .slider {
          background-color: #2196F3;
        }

        input:focus + .slider {
          box-shadow: 0 0 1px #2196F3;
        }

        input:checked + .slider:before {
          -webkit-transform: translateX(26px);
          -ms-transform: translateX(26px);
          transform: translateX(26px);
        }

        /* Rounded sliders */
        .slider.round {
          border-radius: 34px;
        }

        .slider.round:before {
          border-radius: 50%;
        }


    </style>
<style>INPUT:-webkit-autofill,SELECT:-webkit-autofill,TEXTAREA:-webkit-autofill{animation-name:onautofillstart}INPUT:not(:-webkit-autofill),SELECT:not(:-webkit-autofill),TEXTAREA:not(:-webkit-autofill){animation-name:onautofillcancel}@keyframes onautofillstart{from{}}@keyframes onautofillcancel{from{}}
</style></head>

  <body>

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/3.0.0/mdb.min.js"></script>
    <script type="text/javascript" src="js/client.js"></script>
	  
    <script type="text/javascript" src="js/soundmanager2-jsmin.js"></script>

  <script>
	  //const fs = require('fs');
         soundManager.setup({
         // url: '',
         // flashVersion: 9, // optional: shiny features (default = 8)
          // optional: ignore, // Flash where possible, use 100% HTML5 mode
           preferFlash: false,
           onready: function() {
             // Ready to use; soundManager.createSound() etc. can now be called.
             soundManager.createSound({
               url: ["pianomp3/jobro/C3.wav"],
               id: "C3",
               autoLoad: true
             });

             soundManager.createSound({
               url: ["pianomp3/jobro/Db3.wav"],
               id: "Db3",
               autoLoad: true
             });
            
             soundManager.createSound({
               url: ["pianomp3/jobro/D3.wav"],
               id: "D3",
               autoLoad: true
             });

             soundManager.createSound({
               url: ["pianomp3/jobro/Eb3.wav"],
               id: "Eb3",
               autoLoad: true
             });
             soundManager.createSound({
               url: ["pianomp3/jobro/E3.wav"],
               id: "E3",
               autoLoad: true
             });

             soundManager.createSound({
               url: ["pianomp3/jobro/F3.wav"],
               id: "F3",
               autoLoad: true
             });

             soundManager.createSound({
               url: ["pianomp3/jobro/Gb3.wav"],
               id: "Gb3",
               autoLoad: true
             });

             soundManager.createSound({
               url: ["pianomp3/jobro/G3.wav"],
               id: "G3",
               autoLoad: true
             });

             soundManager.createSound({
               url: ["pianomp3/jobro/Ab3.wav"],
               id: "Ab3",
               autoLoad: true
             });

             soundManager.createSound({
               url: ["pianomp3/jobro/A3.wav"],
               id: "A3",
               autoLoad: true
             });

             soundManager.createSound({
               url: ["pianomp3/jobro/Bb3.wav"],
               id: "Bb3",
               autoLoad: true
             });
            
             soundManager.createSound({
               url: ["pianomp3/jobro/B3.wav"],
               id: "B3",
               autoLoad: true
             });

             soundManager.createSound({
               url: ["pianomp3/jobro/C4.wav"],
               id: "C4",
               autoLoad: true
             });
             soundManager.createSound({
               url: ["pianomp3/jobro/Db4.wav"],
               id: "Db4",
               autoLoad: true
             });

             soundManager.createSound({
               url: ["pianomp3/jobro/D4.wav"],
               id: "D4",
               autoLoad: true
             });

             soundManager.createSound({
               url: ["pianomp3/jobro/Eb4.wav"],
               id: "Eb4",
               autoLoad: true
             });

             soundManager.createSound({
               url: ["pianomp3/jobro/E4.wav"],
               id: "E4",
               autoLoad: true
             });

             soundManager.createSound({
               url: ["pianomp3/jobro/F4.wav"],
               id: "F4",
               autoLoad: true
             });

             soundManager.createSound({
               url: ["pianomp3/jobro/Gb4.wav"],
               id: "Gb4",
               autoLoad: true
             });

             soundManager.createSound({
               url: ["pianomp3/jobro/G4.wav"],
               id: "G4",
               autoLoad: true
             });

             soundManager.createSound({
               url: ["pianomp3/jobro/Ab4.wav"],
               id: "Ab4",
               autoLoad: true
             });
            
             soundManager.createSound({
               url: ["pianomp3/jobro/A4.wav"],
               id: "A4",
               autoLoad: true
             });

             soundManager.createSound({
               url: ["pianomp3/jobro/Bb4.wav"],
               id: "Bb4",
               autoLoad: true
             });
             soundManager.createSound({
               url: ["pianomp3/jobro/B4.wav"],
               id: "B4",
               autoLoad: true
             });

           }
         }).beginDelayedInit();
       </script>
     <div class="piano_zone">
         <div class="content clearfix">
            <h2>EAR TRAINING - TONIC FINDER</h2>
            
            <div class="btnsWrapper">
              <div class="stop_music hide">Stop Music</div>
              <div class="start_music hide">Start Music</div>
              <div class="start_game">Start Game</div>
              <div class="next_music hide">Next Song</div>
              <div class="repeat_music hide">Repeat Song</div>
			  <div class="load_music">Load Song</div>
            </div>

            <div class="songsWrapper">
              <div class="song hide" data-song="1" data-note="Bb">
                Bohemian Rhapsody
                <i class="fa fa-solid fa-volume-up hide"></i>
              </div>
              <audio data-sound="0.1" src="pianoSongs/bohemianRhapsody.mp3"></audio>

              <div class="song" data-song="2" data-note="G">
                Gravity John Mayer
                <i class="fa fa-solid fa-volume-up hide"></i>
              </div>
              <audio data-sound="2" src="pianoSongs/gravityJohnmayer.mp3"></audio>

              <div class="song" data-song="3" data-note="Bb">
                Purple Rain Prince
                <i class="fa fa-solid fa-volume-up hide"></i>
              </div>
              <audio data-sound="3" src="pianoSongs/purpleRainPrince.mp3"></audio>

              <div class="song" data-song="4" data-note="A">
                September EWF
                <i class="fa fa-solid fa-volume-up hide"></i>
              </div>
              <audio data-sound="4" src="pianoSongs/septemberEWF.mp3"></audio>

              <div class="song" data-song="5" data-note="A">
                Stairway to Heaven Led Zeppelin
                <i class="fa fa-solid fa-volume-up hide"></i>
              </div>
              <audio data-sound="5" src="pianoSongs/stairwayToHeavenLed.mp3"></audio>

              <div class="song" data-song="6" data-note="Gb" data-quality="minor">
                Billie Jean Michael Jackson
                <i class="fa fa-solid fa-volume-up hide"></i>
              </div>
              <audio data-sound="6" src="pianoSongs/billieJeanMJ.mp3"></audio>

              <div class="song" data-song="7" data-note="Gb">
                Wonderwall Oasis
                <i class="fa fa-solid fa-volume-up hide"></i>
              </div>
              <audio data-sound="7" src="pianoSongs/wonderwallOasis.mp3"></audio>

              <div class="song" data-song="8" data-note="F" data-quality="minor">
                Happy Pharrell Williams
                <i class="fa fa-solid fa-volume-up hide"></i>
              </div>
              <audio data-sound="8" src="pianoSongs/happyPharell.mp3"></audio>

              <div class="song" data-song="9" data-note="A">
                Someone Like You Adele
                <i class="fa fa-solid fa-volume-up hide"></i>
              </div>
              <audio data-sound="9" src="pianoSongs/someoneLikeYouAdele.mp3"></audio>

              <div class="song" data-song="10" data-note="B">
                Hotel California The Eagles
                <i class="fa fa-solid fa-volume-up hide"></i>
              </div>
              <audio data-sound="10" src="pianoSongs/hotelCaliforniaEagles.mp3"></audio>

              <div class="song" data-song="11" data-note="C">
                All The Smalls Things Blink 182
                <i class="fa fa-solid fa-volume-up hide"></i>
              </div>
              <audio data-sound="11" src="pianoSongs/allTheSmallThingsBlink182.mp3"></audio>

              <div class="song" data-song="12" data-note="F" data-quality="minor">
                Smells Like Teen Spirit
                <i class="fa fa-solid fa-volume-up hide"></i>
              </div>
              <audio data-sound="12" src="pianoSongs/smellsLikeTeenSpiritNirvana.mp3"></audio>
              
              <div class="song" data-song="13" data-note="C" data-quality="major">
                Build Me Up Butter Cup                
                <i class="fa fa-solid fa-volume-up hide"></i>
              </div>
              <audio data-sound="13" src="pianoSongs/BuildMeUpButterCup.mp3"></audio>
                      
              <div class="song" data-song="14" data-note="G" data-quality="major">
                Creep Radiohead              
                <i class="fa fa-solid fa-volume-up hide"></i>
              </div>
              <audio data-sound="14" src="pianoSongs/creepRadiohead.mp3"></audio>

              <div class="song" data-song="15" data-note="G" data-quality="major">
                Blackbird The Beatles     
                <i class="fa fa-solid fa-volume-up hide"></i>
              </div>
              <audio data-sound="15" src="pianoSongs/blackbirdBeatles.mp3"></audio>

              <div class="song" data-song="16" data-note="G" data-quality="major">
                Wish You Were Here Floyd
                <i class="fa fa-solid fa-volume-up hide"></i>
              </div>
              <audio data-sound="16" src="pianoSongs/wishYouWereHereFloyd.mp3"></audio>

              <div class="song" data-song="17" data-note="A" data-quality="minor">
                On The Beach Neil Young
                <i class="fa fa-solid fa-volume-up hide"></i>
              </div>
              <audio data-sound="17" src="pianoSongs/onTheBeachNeilYoung.mp3"></audio>

              <div class="song" data-song="18" data-note="E" data-quality="major">
                Satisfaction Rolling Stones
                <i class="fa fa-solid fa-volume-up hide"></i>
              </div>
              <audio data-sound="18" src="pianoSongs/satisfactionRollingStones.mp3"></audio>

              <div class="song" data-song="19" data-note="E" data-quality="mixo">
                Cocaine Eric Clapton
                <i class="fa fa-solid fa-volume-up hide"></i>
              </div>
              <audio data-sound="19" src="pianoSongs/cocaineClapton.mp3"></audio>
              
              <div class="song" data-song="20" data-note="D" data-quality="minor">
                Layla Eric Clapton
                <i class="fa fa-solid fa-volume-up hide"></i>
              </div>
              <audio data-sound="20" src="pianoSongs/laylaClapton.mp3"></audio>
              
              <div class="song" data-song="21" data-note="Ab" data-quality="major">
                Viva La Vida ColdPlay
                <i class="fa fa-solid fa-volume-up hide"></i>
              </div>
              <audio data-sound="21" src="pianoSongs/vivaLaVidaColdplay.mp3"></audio>
              
              <div class="song" data-song="22" data-note="C" data-quality="major">
                Hallelujah Leonard Cohen
                <i class="fa fa-solid fa-volume-up hide"></i>
              </div>
              <audio data-sound="22" src="pianoSongs/hallelujahLeonardCohen.mp3"></audio>

              
              <div class="song" data-song="23" data-note="B" data-quality="major">
                I'm Yours Jason Mraz
                <i class="fa fa-solid fa-volume-up hide"></i>
              </div>
              <audio data-sound="23" src="pianoSongs/imYoursJasonMraz.mp3"></audio>

              <div class="song" data-song="24" data-note="E" data-quality="minor">
                Lucky Jason Mraz
                <i class="fa fa-solid fa-volume-up hide"></i>
              </div>
              <audio data-sound="24" src="pianoSongs/luckyJasonMraz.mp3"></audio>
              
              <div class="song" data-song="25" data-note="D" data-quality="major">
                If It Kills Me Jason Mraz
                <i class="fa fa-solid fa-volume-up hide"></i>
              </div>
              <audio data-sound="25" src="pianoSongs/ifItKillsMeJasonMraz.mp3"></audio>
              
              <div class="song" data-song="26" data-note="G" data-quality="major">
                Brown Eyed Girl Van Morrison
                <i class="fa fa-solid fa-volume-up hide"></i>
              </div>
              <audio data-sound="26" src="pianoSongs/BrownEyedGirlVanMorrison.mp3"></audio>

              <div class="song" data-song="27" data-note="Bb" data-quality="major">
                Walking on Sunshine Katrina
                <i class="fa fa-solid fa-volume-up hide"></i>
              </div>
              <audio data-sound="27" src="pianoSongs/WalkingOnSunshineKatrina.mp3"></audio>

              <div class="song" data-song="28" data-note="Bb" data-quality="major">
                Roar Katy Perry
                <i class="fa fa-solid fa-volume-up hide"></i>
              </div>
              <audio data-sound="28" src="pianoSongs/roarKatyPerry.mp3"></audio>

              <div class="song" data-song="29" data-note="B" data-quality="major">
                The Lazy Song Bruno Mars
                <i class="fa fa-solid fa-volume-up hide"></i>
              </div>
              <audio data-sound="29" src="pianoSongs/theLazySongBruno Mars.mp3"></audio>

              <div class="song" data-song="30" data-note="Db" data-quality="minor">
                Shape of You Ed Sheeran
                <i class="fa fa-solid fa-volume-up hide"></i>
              </div>
              <audio data-sound="30" src="pianoSongs/shapeOfYouEdSheeran.mp3"></audio>

              <div class="song" data-song="31" data-note="E" data-quality="major">
                Hey, Soul Sister Train
                <i class="fa fa-solid fa-volume-up hide"></i>
              </div>
              <audio data-sound="31" src="pianoSongs/heySoulSisterTrain.mp3"></audio><div class="song" data-song="32" data-note="F " data-quality="minor">Kllo - Bolide<i class="fa fa-solid fa-volume-up hide"></i></div><audio data-sound="32" src="pianoSongs/Kllo - Bolide.mp3"></audio><div class="song" data-song="33" data-note="C " data-quality="minor">FNL New Life<i class="fa fa-solid fa-volume-up hide"></i></div><audio data-sound="33" src="pianoSongs/FNL New Life.wav"></audio>


              

              <div></div>
            </div>

            <div class="keysWrapper">
              <div data-note="C">C</div>
              <div data-note="Db">Db</div>
              <div data-note="D">D</div>
              <div data-note="Eb">Eb</div>
              <div data-note="E">E</div>
              <div data-note="F">F</div>
              <div data-note="Gb">Gb</div>
              <div data-note="G">G</div>
              <div data-note="Ab">Ab</div>
              <div data-note="A">A</div>
              <div data-note="Bb">Bb</div>
              <div data-note="B">B</div>
            </div>

            <div class="piano">
                <div class="key" data-note="C3"></div>
                <div class="black-key" data-note="Db3"></div>
                <div class="key" data-note="D3"></div>
                <div class="black-key" data-note="Eb3"></div>
                <div class="key" data-note="E3"></div>
                <div class="key half" data-note="F3"></div>
                <div class="black-key" data-note="Gb3"></div>
                <div class="key" data-note="G3"></div>
                <div class="black-key" data-note="Ab3"></div>
                <div class="key" data-note="A3"></div>
                <div class="black-key" data-note="Bb3"></div>
                <div class="key" data-note="B3"></div>

                <div class="key half" data-note="C4"></div>
                <div class="black-key" data-note="Db4"></div>
                <div class="key" data-note="D4"></div>
                <div class="black-key" data-note="Eb4"></div>
                <div class="key" data-note="E4"></div>
                <div class="key half" data-note="F4"></div>
                <div class="black-key" data-note="Gb4"></div>
                <div class="key" data-note="G4"></div>
                <div class="black-key" data-note="Ab4"></div>
                <div class="key" data-note="A4"></div>
                <div class="black-key" data-note="Bb4"></div>
                <div class="key" data-note="B4"></div>
              </div>

              <div class="settings">
                <div class="announcement">
                  <h3>1. Click Start Game</h3>
                  <h3>2. Use the keyboard to assist you identifying the tonic</h3>
                  <h3>3. Then select the tonic from the letters above the keyboard</h3>
                </div>
                <h4 class="hide">Songs Will Play:</h4>
                <div class="behavior_controls hide">
                  <span>Manual</span>
                  <label class="switch">
                    <input class="switch_check" type="checkbox">
                    <span class="slider round"></span>
                  </label>
                  <span>Auto</span>
                </div>

                <div class="volume_controls">
                  <label class="songVolText">Song Volume: </label>
                  <input class="songVolInput" type="range" id="volume" value="100">
                  
                  <label class="pianoVolText">Piano Volume: </label>
                  <input class="pianoVolInput" type="range" id="volume2" value="100">
                </div>
				
				<form id="uploadForm" action="/api/uploadFolder" method="POST" enctype="multipart/form-data">
				    <input type="file" name="folderPath" id="folderPath" webkitdirectory="" directory="" multiple="" autocompleted="">
				    <button type="submit">Upload Folder</button>
				  </form>
              </div>

              <script type="module">
				  
				  // Function to chunk data into smaller segments
				  function chunkData(data, chunkSize) {
				      const chunks = [];
				      for (let i = 0; i < data.length; i += chunkSize) {
				          chunks.push(data.slice(i, i + chunkSize));
				      }
				      return chunks;
				  }

				  // Function to save data to Local Storage in chunks
				  function saveDataToLocalStorage(data) {
				      const chunkSize = 1000000; // Set the chunk size (e.g., 1MB)
				      const chunks = chunkData(data, chunkSize);
				      chunks.forEach((chunk, index) => {
				          localStorage.setItem(`uploadedFile_${index}`, JSON.stringify(chunk));
				      });
				  }
				  
				  function uploadLocally() {
					  const uploadForm = document.getElementById('uploadForm');

					  uploadForm.addEventListener('submit', function(event) {
					      event.preventDefault(); // Prevent form submission

					      const files = document.getElementById('folderPath').files;
					      if (files.length === 0) {
					          console.log('No files selected.');
					          return;
					      }

					      // Iterate over each file selected
					      for (let i = 0; i < files.length; i++) {
					          const file = files[i];

					          // Read the file as a data URL
					          const reader = new FileReader();
					          reader.readAsDataURL(file);

					          reader.onload = function() {
					              const fileData = {
					                  name: file.name,
					                  type: file.type,
					                  size: file.size,
					                  dataURL: reader.result // The file content as a data URL
					              };

					              // Convert file data to a string (Local Storage can only store strings)
					              const fileDataString = JSON.stringify(fileData);
								  
								  // Example usage
								 //x const largeData = '...'; // Your large data here
								  saveDataToLocalStorage(fileDataString);

								  // Retrieve the data later
								  const retrievedData = retrieveDataFromLocalStorage();

					              // Save the file data string to Local Storage
					              // localStorage.setItem(`uploadedFile_${i}`, fileDataString);

					              console.log(`File ${i + 1} uploaded and saved to Local Storage:`, fileData);
					          };

					          reader.onerror = function(error) {
					              console.error('Error reading file:', error);
					          };
					      }

					      console.log(`${files.length} file(s) uploaded and saved to Local Storage.`);
					  });
				  }
				  
				  
		          // import { myFunction } from './cppjs/test.js';
					  
						  
				  // Get the form element
				  const form = document.getElementById('uploadForm');

				  // Add a submit event listener to the form
				  form.addEventListener('submit', async (event) => {
				    event.preventDefault(); // Prevent the default form submission

					// Get the selected folder path
					const folderPath = document.getElementById('folderPath').files;

					// Create a FormData object to send data in multipart/form-data format
					const formData = new FormData();

					// Iterate over each file in the selected folder
					for (let i = 0; i < folderPath.length; i++) {
					  // Append each file to the FormData object with the same key
					  formData.append('audioFiles', folderPath[i]);
					}
				    
				    // Log the FormData object to the console
				    console.log($(formData));
					
				//	uploadLocally();
					

				    // Send the POST request using fetch
				    try {
				      const response = await fetch('http://localhost:3000/api/upload', {
				        method: 'POST',
				        body: formData
				      });

				      // Check if the request was successful
				      if (!response.ok) {
				        throw new Error('Failed to upload folder');
				      }

				      // Parse the JSON response
				      const data = await response.json();
				      console.log(data); // Do something with the response data
				    } catch (error) {
				      console.error(error);
				    }
					
			
			
				  });
					  
					  
				  function saveChangesHTML(changes) {

					  
					  const modifiedHtml = changes;
					//  console.log(modifiedHtml); // Verify that modifiedHtml contains the expected HTML
					  fetch('http://localhost:3000/api/modify-html', {
					    method: 'POST',
					    headers: {
					      'Content-Type': 'application/json' // Set content type to JSON
					    },
					    body: JSON.stringify({ html: modifiedHtml }) // Serialize modifiedHtml as JSON
					  })
					    .then(response => {
					      // Handle response...
					    })
					    .catch(error => {
					      console.error('Error modifying HTML:', error);
					    });
				  }
				  
				
					  
					  function fetchKeys() {
						  const folderPath = "./uploads";
						  console.log("THIS ONE: "+folderPath);
						  fetch(`http://localhost:3000/api/myFunction?folderPath=${encodeURIComponent(folderPath)}`)
						      .then(response => {
						          if (!response.ok) {
						              throw new Error('Network response was not ok');
						          }
						          return response.json();
						      })
							  .then(response => {
							      // Check if 'result' property exists and is an array
							      if (!response.result || !Array.isArray(response.result)) {
							          console.error('Result is not an array:', response.result);
							          return; // Exit early if 'result' is not an array
							      }

							      // Access the 'result' array
							      const data = response.result;

							      // Assuming data is an array of arrays with [path, key] structure
							      data.forEach(innerArray => {
							          const [path, key] = innerArray; // Destructuring assignment to extract path and key
							          console.log('Path:', path);
							          console.log('Key:', key);
							          // Do something with 'path' and 'key'
									  
								   // Create elements dynamically
								      const div = document.createElement('div');
								      const audio = document.createElement('audio');
								      const i = document.createElement('i');
									  const songCount = parseInt($("div.song:last").attr('data-song'));
									  const pathNew = path.replace(/\.\/uploads/g, 'pianoSongs');
									  const keyNote =  key.slice(0, 2).toUpperCase();
									  const quality = key.slice(2);
									  
								      // Set attributes and text content
								      div.classList.add('song');
								      div.setAttribute('data-song', songCount+1);
								      div.setAttribute('data-note', keyNote); // Extract first two letters of key
								      div.setAttribute('data-quality', quality);
									  // Assuming path is a string containing the file path
									  const lastSlashIndex = path.lastIndexOf('/');
									  const splicedPath = path.slice(10, -4); // Splice the path from the last /
									  
								      div.textContent = splicedPath;
    
								      audio.setAttribute('data-sound', songCount+1);
								      audio.setAttribute('src', pathNew); // Set path as source
    
								      i.classList.add('fa', 'fa-solid', 'fa-volume-up', 'hide');

								      // Append elements to the document
								      div.appendChild(i);
									  const songsWraplast = $("div.song:last").next();
									//  console.log(songsWraplast);
								      songsWraplast.after(div);
								      div.after(audio);
									
									
									 
									}); 
			  					    // Modify the HTML content (assuming this is your modification)
			  					  
			  					 
									const dataInFile = document.documentElement.outerHTML;
									//console.log(dataInFile);
									saveChangesHTML(dataInFile);
									  
							     
							  })
							  .catch(error => {
							      console.error('There was a problem with the request:', error);
							  });
					  }
					  

		           const loadMusicBtn = document.querySelector('.load_music');
		           loadMusicBtn.addEventListener('click', () => {
		               console.log("YAY!");
					   fetchKeys();
				   });
                
				 let globalVol = 0.1;
                 let globalNoteVol = 1;
                 let globalPlayingStyle = 0;
                 let globalSongsPlayed = [];
                 const keys = document.querySelectorAll('.key, .black-key');

                 const songs = document.querySelectorAll('.song');
                 const songKeys = document.querySelectorAll('.keysWrapper > div');
                 const stopBtn = document.querySelector('.stop_music');
                 const btn2 = document.querySelector('.start_game');
                 const btn3 = document.querySelector('.next_music');
                 const repeatBtn = document.querySelector('.repeat_music');
                 const startMusicBtn = document.querySelector('.start_music');
			//	 const loadMusicBtn = document.querySelector('.load_music');	

                 $("document").ready(function() {
                    console.log(globalVol);
                    volume.value = globalVol;
                 });

                 volume.addEventListener("input", (e) => {
                    const currentSong = document.querySelector('div.playing');
                    let audio = document.querySelector(`audio[data-sound="${currentSong.dataset.song}"]`);
                     // console.log(e.currentTarget.value);
                    audio.volume = e.currentTarget.value / 100;
                    globalVol = audio.volume;   
                });

                volume.addEventListener("touchmove", (e) => {
                  console.log(e.currentTarget.value);
                  const currentSong = document.querySelector('div.playing');
                    let audio = document.querySelector(`audio[data-sound="${currentSong.dataset.song}"]`);
                     // console.log(e.currentTarget.value);
                    audio.volume = e.currentTarget.value / 100;
                    globalVol = audio.volume;   
                });


                volume2.addEventListener("input", (e) => {
                    const currentKey = document.querySelector('.key');
                    
                    let audio = document.querySelector(`audio[data-sound="${currentKey.dataset.note}"]`);
                    
                    audio.volume = e.currentTarget.value / 100;
                    globalNoteVol = audio.volume;   
                });

                stopBtn.addEventListener('click', () => {
                  const currentSong = document.querySelector('div.playing');
                  stopSong(currentSong.dataset.song);
                  startMusicBtn.classList.remove("hide");
                  stopBtn.classList.add("hide");
                });

                repeatBtn.addEventListener('click', ()=> {
                  const currentSong = document.querySelector('div.activa');
                  playSong(currentSong.dataset.song);

                });

                startMusicBtn.addEventListener('click', ()=> {
                  const currentSong = document.querySelector('div.activa');
                  playSong(currentSong.dataset.song);
                  startMusicBtn.classList.add("hide");
                  stopBtn.classList.remove("hide");
                });
				

                function randomSong() {
                  if(globalSongsPlayed.length < $(".song").length) {
                     //console.log("CHECKED");
                     btn2.style.display = 'none';
                     btn3.style.display = 'block';
                      var randSong = Math. floor(Math. random()*$(".song").length) + 1;
                      if(globalSongsPlayed.includes(randSong)) {
                        console.log("LENGTH: "+globalSongsPlayed.length);
                        randomSong();
                      } else {
                        playSong(randSong);
                        globalSongsPlayed.push(randSong);
                        console.log("VALIDO");
                        console.log(randSong);

                      }
                    } else {
                      //console.log("NOT CHECKED");
                      globalSongsPlayed.length = 0;
                      console.log("STYLE: "+globalPlayingStyle);
                      btn2.style.display = 'block';
                      btn3.style.display = 'none';
                      //randomSong();
                    }
                }

                btn2.addEventListener('click', () => {
                  console.log("START GAME NOW");
                  
                  randomSong();
                });

                btn3.addEventListener('click', () => {
                 // console.log("START GAME NOW");
                  ///btn2.hide();
                  randomSong();
                  startMusicBtn.classList.add("hide");
                });

                 function playSongAuto() {
                  console.log("PLAYING AUTOMATICALLY");
                 }

                 function playSound(note) {
                  const audio = document.querySelector(`audio[data-sound="${note}"]`);
                     if (!audio) return;
                     audio.currentTime = 0.0;
                    // if (note = 'D') {audio.currentTime = 0.8;}
                     audio.volume = globalNoteVol;
                     audio.play();
                 }

                 function stopSound(note) {
                  
                  /*
                     const audio = document.querySelector(`audio[data-sound="${note}"]`);
                     if (!audio) return;
                     audio.pause();
                 */
                    }
					var currPlaying = [];
                 function playSong(note) {
                     if (currPlaying = document.querySelector('div.playing')) {
                        stopSong(currPlaying.dataset.song);
                     };
                     
                     const audio = document.querySelector(`audio[data-sound="${note}"]`);
                     if (!audio) return;
                     audio.currentTime = 0;
                     audio.volume = globalVol;
                     audio.play();
                     const songPlaying = document.querySelector(`div[data-song="${note}"]`);
                     const songs = document.querySelectorAll('div.song');
                     const repeatBtn = document.querySelector('div.repeat_music');
                     const stopBtn = document.querySelector('div.stop_music');

                     songs.forEach(song => {
                        song.classList.remove('activa');
                     });

                     songPlaying.classList.add('playing');
                     songPlaying.classList.add('activa');
                     btn2.classList.add('hide');
                     btn3.classList.remove('hide');
                     repeatBtn.classList.remove('hide');
                     stopBtn.classList.remove('hide');
                     setTimeout(function (){
                        audio.pause();
                        songPlaying.classList.remove('playing');
                      }, 30000);
                 }

                 function stopSong(note) {
                    const audio = document.querySelector(`audio[data-sound="${note}"]`);
                    audio.pause();
                    const songPlaying = document.querySelector('div.playing');
                    songPlaying.classList.remove('playing');
                 }

                 songs.forEach(song => {
                    song.addEventListener('mousedown', () => {
                      const note = song.dataset.song;
                      playSong(note);
                    });
                 });

                 songKeys.forEach(key => {
                  key.addEventListener('mousedown', () => {
                      const currentSong = document.querySelector('div.activa');
                      const songPlaying = document.querySelector('div.playing');
                      const note = key.dataset.note;
                  if(currentSong != null) {
                        $(".announcement").hide();
                        $(".settings").addClass("noBanner");
                        const currentKey = currentSong.dataset.note;
                        const song = currentSong.dataset.song;
                        console.log(note);
                        if(note == currentKey) {
                          key.classList.add('right');
                          songKeys.forEach(key1 => {
                            if(key != key1) {key1.classList.remove('wrong');}
                          });
                          if(songPlaying != null) {
                            stopSong(song);
                          }
                          setTimeout(function (){
                              key.classList.remove('right');
                              randomSong();
                          }, 600);
                         } else {
                          key.classList.add('wrong');
                         }
                      }
                 });

                 key.addEventListener('touchstart', () => {
                    /* use if you need something to be only on TOUCH. if nothing here TOUCH uses MOUSEDOWN above*/
                    preventDefault();
                    stopPropagation();
                 });
                });

                 keys.forEach(key => {
                    
                     key.addEventListener('mousedown', () => {
                      const currentSong = document.querySelector('div.playing');
                         const note = key.dataset.note;
                         soundManager.stopAll();
                         soundManager.play(note);
                          //playSound(note);
                         key.classList.add('active');
                     });

                     key.addEventListener('mouseup', () => {
                         key.classList.remove('active');
                       //  stopSound(key.dataset.note);
                     });

                     key.addEventListener('mouseleave', () => {
                         key.classList.remove('active');
                        // stopSound(key.dataset.note);
                     });

                     key.addEventListener('touchstart', (event) => {
                      const currentSong = document.querySelector('div.playing');
                         const note = key.dataset.note;
                         soundManager.stopAll();
                         soundManager.play(note);
                          //playSound(note);
                          event.preventDefault();
                         key.classList.add('active');
                     });

                     key.addEventListener('touchend', () => {
                         key.classList.remove('active');
                         //stopSound(key.dataset.note);
                     });
                 });

                 window.addEventListener('keydown', (event) => {
                  const currentSong = document.querySelector('div.playing');
                         const note = key.dataset.note;
                         soundManager.stopAll();
                         soundManager.play(note);
                          //playSound(note);
                         key.classList.add('active');
                 });

                 window.addEventListener('keyup', (event) => {
                     const key = event.key.toUpperCase();
                     const keyElement = document.querySelector(`.key[data-note="${key}"]`);
                     if (!keyElement) return;
                     keyElement.classList.remove('active');
                     // stopSound(key.dataset.note);
                 });

                const checkBox = document.querySelector("input.switch_check");
                checkBox.addEventListener('click', ()=> {
                    if(checkBox.checked) {
                      globalPlayingStyle = 1;
                    } else {
                      globalPlayingStyle = 0
                    }
                    console.log(globalPlayingStyle);
                });


             </script>

         </div>
     </div>
  

</body></html>